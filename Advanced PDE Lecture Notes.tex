\documentclass{report}

\input{preamble}

\title{\Huge{Advanced Topics in Partial Differential Equations}}
\author{Lecturer: Anna Kostianko \\ Transcribed by Harry Li}
\date{2023}

\begin{document}
\input{title.tex}
\newpage

\pdfbookmark[section]{\contentsname}{toc}
\tableofcontents

\chapter{Distributions}
\section{Fourier Transform on tempered distributions}
The goal is to extend the notion of Fourier transform to the class of tempered distributions (dual of Schwartz space). We know that the Fourier transform is well-defined for \(\mathcal{F}: S \rightarrow S\).

\[\langle \mathcal{F}f, \varphi \rangle = \langle f, \mathcal{F} \varphi \rangle, f \in S', \varphi \in S\]

\begin{example}{}{}
    Fourier Transform on delta function:
    \begin{align*}
        \langle \mathcal{F}\delta(\xi), \varphi(\xi) \rangle &= \langle \delta(\xi), \mathcal{F} \varphi(\xi) \rangle \\
        &= \langle \delta(\xi), \mathcal{F}\varphi(\xi) \rangle \\
        &= \left\langle \delta(\xi), \int_{\mathbb{R}} e^{-ix\xi}\varphi(x) \mathrm{d}x \right\rangle \\
        &= \int_{\mathbb{R}} \int_{\mathbb{R}} \delta(\xi) e^{-ix\xi}\varphi(x) \mathrm{d}x \mathrm{d}\xi \\
        &= \int_{\mathbb{R}} \varphi(x) \mathrm{d}x \\
        &= \langle 1, \varphi(x) \rangle
    \end{align*}
    Hence $\mathcal{F} \delta(x) = 1$.
\end{example}

\begin{example}{}{}
    Fourier transform of the constant function $f(x)=1$:
    \begin{align*}
        \langle \mathcal{F}1, \varphi(\xi) \rangle &= \int_{\mathbb{R}} \int_{\mathbb{R}} e^{-ix\xi}\varphi(x)\,\mathrm{d}x\,\mathrm{d}\xi
    \end{align*}
    We cannot directly apply Fubini's theorem to the above integral because $g(\xi) := e^{-ix\xi} \notin L^1(\mathbb{R})$. Therefore, we must approximate $g$. We know $\mathcal{S}(\mathbb{R})$ is dense in $\mathcal{S'}(\mathbb{R})$. Take $f_{n}(x) \in \mathcal{S}$ with $f_{n} \rightarrow f$ in $\mathcal{S}'$.
\end{example}

\chapter{Sobolev spaces}
\section{Interpolation inequalities}

\begin{example}{}{}
    \begin{equation} \label{eq:1}
        \|u\|_{L^{\infty}}^{2} \leq \|u\|_{L^{2}} \|u'\|_{L^{2}} \text{ for } u \in C^{\infty}(\mathbb{R}) 
    \end{equation}
\end{example}

\begin{proof}
    Idea: use that \((u^2)' = 2uu'\) and Newton-Leibniz
    \begin{align*}
        u^2(x) &= 2 \int_{-\infty}^{x} u u' \,\mathrm{d}y = -2 \int_{x}^{\infty} u u' \,\mathrm{d}y \\
        &= \int_{-\infty}^{x} u u' \,\mathrm{d}y - \int_{x}^{\infty} u u' \,\mathrm{d}y \\
        & \leq \int_{-\infty}^{x} \vert u \vert \vert u' \vert \,\mathrm{d}y + \int_{x}^{\infty} \vert u \vert \vert u' \vert \,\mathrm{d}y \\
        &= \int_{\mathbb{R}} \vert u \vert \vert u' \vert \,\mathrm{d}y \\
        \text{(Hölder's inequality)} \quad & \leq \|u\|_{L^{2}} \|u'\|_{L^{2}}
    \end{align*}
\end{proof}

\qs{}
{
    Check that \ref{eq:1} is sharp. Namely, that \ref{eq:1} becomes equality for \(u(x) = e^{-\vert x \vert}\) (\(u(x)\) is an extremal function for \ref{eq:1}). Also, \ref{eq:1} is shift and scaling invariant, i.e. \(u_{\alpha}(x+h) = e^{-\alpha|x+h|}, h \in \mathbb{R}, \alpha>0\) -extremals.
}

\begin{example}{Interpolation inequality}{}
    \(\Omega\)-domain in \(\mathbb{R}^{n}, u \in L_{p_1}(\Omega) \cap L_{p_2}(\Omega), 1 \leq p_1, p_2, < \infty, p_1 < p_2, \theta \in [0, 1], \frac{1}{p} = \frac{\theta}{p_1} + \frac{1-\theta}{p_2}\). Then
    \begin{equation}\label{eq:2}
        \|u\|_{L^{p}} \leq \|u\|_{L^{p_1}}^{\theta} \|u\|_{L^{p_2}}^{1 - \theta}
    \end{equation} 
\end{example}

\begin{proof}
    \[\int_{\mathbb{R}} \vert u \vert^p \,\mathrm{d}x = \int_{\mathbb{R}} \vert u \vert^{\theta p} \vert u \vert^{(1-\theta) p} \,\mathrm{d}x\]
    We apply Hölder's inequality with exponents \(P = \frac{p_1}{\theta p} \) and \(Q = \frac{p_2}{(1-\theta)p}\) (Note \(\frac{1}{P} + \frac{1}{Q} = \frac{\theta p}{p_1} + \frac{(1-\theta)p}{p_2} = 1\)). Then
    \begin{align*}
        \int_{\mathbb{R}} \vert u \vert^{\theta p} \vert u \vert^{(1-\theta) p} \,\mathrm{d}x &\leq \left(\int_{\mathbb{R}} \vert u \vert^{p_1} \,\mathrm{d}x \right)^{\frac{1}{P}} \left(\int_{\mathbb{R}} \vert u \vert^{p_2} \,\mathrm{d}x \right)^{\frac{1}{Q}} \\
        &= \|u\|_{L^{p_1}}^{\theta} \|u\|_{L^{p_2}}^{1 - \theta}
    \end{align*}
\end{proof}

\section{Sobolev inequalities}

\begin{example}{Sobolev inequality 1D}{}
    \(u \in C^{\infty}([0,1])\), want to prove the embedding \(W^{1, 1}([0,1]) \subset C([0,1])\), i.e.
    \begin{equation}\label{eq:3}
        \|u\|_{C([0,1])} \leq \|u\|_{L^{1}([0,1])} + \|u'\|_{L^{1}([0,1])}
    \end{equation}
\end{example}

\begin{proof}
    By the Newton-Leibniz formula, \(u(x) - u(y) = \int_{y}^{x} u'(s) \,\mathrm{d}s\). Also,
    \[|u(x)| \leq |u(y)| + \int_{0}^{1} |u'(s)| \,\mathrm{d}s \quad \forall x, y \in [0,1]\]
    By integration over \(y \in [0,1]\), 
    \[|u(x)| \leq \int_{0}^{1} |u(s)| \,\mathrm{d}s + \int_{0}^{1} |u'(s)| \,\mathrm{d}s = \|u\|_{W^{1, 1}([0, 1])}\]

    Taking supremum with respect to \(x \in [0,1]\), we obtain \(\|u\|_{C([0,1])} \leq \|u\|_{W^{1, 1}([0, 1])}\)
\end{proof}

\ex{Sobolev inequality 2D}
{
    \(u \in C^{\infty}([0,1]^2)\), i.e. \(\Omega = [0,1]^2\), then \(W^{1, 1}(\Omega) \subset L^{2}(\Omega) : \|u\|_{L^{2}} \leq \|u\|_{W^{1, 1}(\Omega)}\)
}

\begin{proof}
    \(\int_{\Omega} u^{2}(x_1, x_2) \,\mathrm{d}x_1 \,\mathrm{d}x_2\) should be estimated. From \ref{eq:3}, we know that 
    \[\vert u(x_1, x_2) \vert \leq \int_{0}^{1} \vert u(s, x_2) \vert + |\partial_{x_1} u(s, x_2)| \,\mathrm{d}s \coloneqq f(x_2)\]
    \[\vert u(x_1, x_2) \vert \leq \int_{0}^{1} \vert u(x_1, s) \vert + |\partial_{x_2} u(x_1, s)| \,\mathrm{d}s \coloneqq g(x_1)\]
    Then 
    \begin{align*}
        \int_{\Omega} u^2 \,\mathrm{d}x &\leq \int_{0}^{1} g(x_1)f(x_2) \,\mathrm{d}x_1 \,\mathrm{d}x_2 \\
        &= \int_{0}^{1} f(x_2) \,\mathrm{d}x_2 \int_{0}^{1} g(x_1) \,\mathrm{d}x_1 \\
        &= \left(\int_{\Omega} \vert u(x_1, x_2) \vert + \vert \partial_{x_1} u(x_1, x_2) \vert \,\mathrm{d}x_1 \right) \left(\int_{\Omega} \vert u(x_1, x_2) \vert + \vert \partial_{x_2} u(x_1, x_2) \vert \,\mathrm{d}x_2 \right) \\
        &\leq \|u\|_{W^{1, 1}(\Omega)}^{2}
    \end{align*}
\end{proof}

\qs{Sobolev inequality 3D}
{
    \(u \in C^{\infty}(\bar{\Omega}), \Omega = (0,1)^3\). Prove that \(W^{1, 1}(\Omega) \subset L^{\frac{3}{2}}(\Omega)\), i.e.
    \begin{equation}\label{eq:4}
        \|u\|_{L^{\frac{3}{2}}(\Omega)} \leq \|u\|_{W^{1, 1}(\Omega)}
    \end{equation}
    Hint: first, prove that
    \[\int_{\Omega} f(x_1, x_2)g(x_2, x_3)h(x_1, x_3) \,\mathrm{d}x \leq \|f\|_{L^{2}} \|g\|_{L^{2}} \|h\|_{L^{2}}\]
    and use \ref{eq:3}.
}

\begin{example}{}{}
    \(u \in C^{\infty}(\bar{\Omega}), \Omega = (0,1)^3\). Then 
    \begin{equation}
        \|u\|_{L^{6}(\Omega)} \leq C \|u\|_{W^{1, 2}(\Omega)}
    \end{equation}
\end{example} 

\begin{proof}
    \begin{align*}
        \int_{\Omega} \vert u \vert^{6} \,\mathrm{d}x &= \int_{\Omega} (\vert u \vert^{4})^{\frac{3}{2}} \,\mathrm{d}x \\
        (\text{by \eqref{eq:4}}) \quad &\leq C \left(\int_{\Omega} \vert u \vert^{4} \,\mathrm{d}x + \int_{\Omega} u^{3}|\nabla u| \,\mathrm{d}x \right)^{\frac{3}{2}} \\
        &\leq C \left(\int_{\Omega} \vert u \vert^{4} \,\mathrm{d}x\right)^{\frac{3}{2}} + C \left(\int_{\Omega} \vert u \vert^{3} \vert \nabla u \vert \,\mathrm{d}x \right)^{\frac{3}{2}} \\
        (\text{by \eqref{eq:2}}) \quad &\leq C \|u\|^{\frac{3}{2}\cdot \theta \cdot 4}_{L^{2}} \|u\|^{\frac{3}{2}\cdot (1-\theta) \cdot 4}_{L^{6}} + C \|u\|^{\frac{3}{2}\cdot 3}_{L^{6}} \|\nabla u\|^{\frac{3}{2}}_{L^{2}} \\
        \left(\theta = \frac{1}{4}\right) \quad &= C \|u\|^{\frac{3}{2}}_{L^{2}} \|u\|^{\frac{9}{2}}_{L^{6}} + C\|u\|^{\frac{9}{2}}_{L^{6}} \|\nabla u\|^{\frac{3}{2}}_{L^{2}} \\
        \left(\text{Young's inequality with } p=\frac{4}{5} \text{ and }q=-4\right) \quad &\leq \varepsilon \|u\|^{6}_{L^{6}} + C_{\varepsilon}(\|u\|_{L^{2}} + \|\nabla u\|_{L^{2}})^{6}
    \end{align*}
    Setting for example, \(\varepsilon = \frac{1}{2}\), we obtain
    \[\|u\|_{L^{6}(\Omega)} \leq C \|u\|_{W^{1, 2}(\Omega)}\]
\end{proof}

\begin{theorem}{Sobolev embeddings}{sobolev_embedding}
    \begin{enumerate}[label=\bfseries\tiny\protect\circled{\small\arabic*}]
		\item \(W^{k_1, p_1}(\Omega) \subset W^{k_2, p_2}(\Omega) \Longleftrightarrow k_1 \geq k_2\) and \(1 \leq p_1, p_2 < \infty, k_1 - \frac{n}{p_1} \geq k_2 - \frac{n}{p_2}, \Omega \subset \mathbb{R}^{n}\).
		\item \(W^{k,p}(\Omega) \subset C^{\alpha}(\Omega)\) if \(\alpha < k - \frac{n}{p}\). If \(\alpha\) is not an integer, then the inequality is weak.
	\end{enumerate}
\end{theorem}

\begin{example}{}{}
    \(H^{s}(\mathbb{R}^{n}) \subset C(\mathbb{R}^{n}) \iff s > \frac{n}{2}\) 
\end{example}

\begin{proof}
    \(u(x) = \int_{\mathbb{R}^{n}} e^{i\xi x} \hat{u}(\xi) \,\mathrm{d}\xi \)
    \begin{align*}
        \vert u(x) \vert &\leq \int_{\mathbb{R}^{n}} \vert \hat{u}(\xi) \vert \,\mathrm{d}\xi \\
        &= \int_{\mathbb{R}^{n}} \left(1+\vert \xi \vert ^{2} \right)^{-\frac{s}{2}} \left(1+\vert \xi \vert ^{2} \right)^{\frac{s}{2}} \vert \hat{u}(\xi) \vert \,\mathrm{d}\xi \\
        \text{(Hölder's inequality)} \quad &\leq \left(\int_{\mathbb{R}^{n}} \frac{1}{\left(1+\vert \xi \vert ^{2}  \right)^{s}} \,\mathrm{d}\xi \right)^{\frac{1}{2}} \left(\int_{\mathbb{R}^{n}} \left(1+\vert \xi \vert ^{2} \right)^{s} \vert \hat{u}(\xi) \vert^{2} \,\mathrm{d}\xi \right)^{\frac{1}{2}}
    \end{align*} 

    \(\int_{\mathbb{R}^{n}} \frac{1}{\left(1+\vert \xi \vert ^{2} \right)^{s}} \,\mathrm{d}\xi < \infty \iff s>\frac{n}{2}\).
    Taking the supremum with respect to \(x \in \mathbb{R}^{n}\), we get
    \[\|u\|_{C(\mathbb{R}^{n})} \leq C_{s}\|u\|_{H^{s}(\mathbb{R}^{n})}\]
\end{proof}

\begin{theorem}{Interpolation inequalities}{}
    Let \(u \in W^{k_1, p_1}(\Omega) \cap W^{k_2, p_2}(\Omega), \theta \in [0,1], 1\leq p_1, p_2 \leq \infty\) with \(k = \theta k_1 + (1-\theta) k_2, \frac{1}{p} = \frac{\theta}{p_1} + \frac{1-\theta}{p_2} \). Then 
    \[
        \|u\|_{W^{k, p}} \leq C\|u\|_{W^{k_1, p_1}}^{\theta} \|u\|_{W^{k_2, p_2}}^{1-\theta}
    \]
\end{theorem}

\begin{corollary}{Particular cases}{}
    \begin{enumerate}
        \item \(\|u\|_{H^{1}} \leq \|u\|_{L^{2}}^{\frac{1}{2}} \|u\|_{H^{2}}^{\frac{1}{2}}\)
        \item \(\|u\|_{L^{p}} \leq \|u\|_{L^{p}}^{\theta} \|u\|_{H^{2}}^{1-\theta}\) 
    \end{enumerate}
\end{corollary}

\section{Spaces with zero boundary traces}
\begin{definition}{}{}
    \(W^{1, p}_{0}(\Omega) \coloneqq \left\{u \in W^{1, p}(\Omega), \left. u \right|_{\partial \Omega} = 0\right\} \)

    An equivalent definition is that the Sobolev spaces \(W^{1, p}_{0}(\Omega)\) for \(1 \leq p < \infty\) are defined as the closure of the set of compactly supported test functions \(C_{0}^{\infty}(\Omega)\) with respect to the \(W^{1, p}(\Omega)\)-norm.
\end{definition}

\mlemma{}
{
    These two definitions are equivalent. \(u \in \text{``closure"} \colon u = \lim\limits_{n \to \infty} \varphi_{n}, \varphi_{n} \in C^{\infty}_{0}(\Omega) \implies \left. \varphi_{n} \right|_{\partial \Omega} = 0\). By continuity, \(\left. u \right|_{\partial \Omega} = 0\). The proof of the converse statement is more technical and is omitted.
}

\section{Poincaré's and Friedrich's inequalities}
\mprop{Friedrich's inequality}
{
    Let \(\Omega\) be a bounded domain and \(u \in W^{1, p}_{0}(\Omega)\). Then
    \begin{equation}\label{eq:5}
        \|u\|_{L^{p}} \leq C \|\nabla u\|_{L^{p}} 
    \end{equation}
}

\begin{proof}
    It is enough to prove \ref{eq:5} for \(\varphi \in C^{\infty}_{0}(\Omega)\). Suppose \(\Omega\) is bounded in the \(x_{1}\) direction by \(L\). By the Newton-Leibniz formula,
    \[    
        u(x_1, x') - u(-L, x') = u(x_1, x') = \int_{-L}^{x_1} \partial_{x_1}u(s, x') \,\mathrm{d}s 
    \]
    \begin{align*}
        \vert u(x_1, x') \vert ^{p} &\leq \left(\int_{-L}^{L} \vert \partial_{x_1}u(s, x') \vert \,\mathrm{d}s \right)^{p} \\
        \text{(Hölder's inequality)} \quad & \leq C_{L} \int_{-L}^{L} \vert \partial_{x_1}u(s, x') \vert^{p} \,\mathrm{d}s
    \end{align*}
    Integration with respect to $x'$ gives us
    \[
        \int_{\mathbb{R}^{n-1}} \vert u(x_1, x') \vert ^{p} \,\mathrm{d}x' \leq C_{L}\|\partial_{x_1}u\|_{L^{p}}^{p}
    \]
    Finally, integrating over \(x_1 \in [-L, L]\), we obtain
    \[
        \|u\|_{L^{p}}^{p} \leq 2LC_{L} \|\partial_{x_1}u\|_{L^{p}}^{p}
    \]
\end{proof}

\cor{Equivalent norm in \(W^{1, p}_{0}(\Omega)\)}
{
    Homogeneous norm:
    \[
        \|u\|_{W^{1, p}_{0}(\Omega)} \coloneqq \|\nabla u\|_{L^{p}}
    \]
}

\begin{note}
    \(\left. u \right|_{\partial \Omega} = 0\) is important! Otherwise, \ref{eq:5} will fail for \(u \equiv c\). Since \(\nabla u\) defines \(u\) up to a constant; \(\left. u \right|_{\partial \Omega} = 0\) removes this constant.
\end{note}

\mprop{Poincaré inequality}
{
    Let \(\Omega\) be a bounded domain with a smooth boundary and \(\left\langle u \right\rangle \coloneqq \frac{1}{\vert \Omega \vert } \int_{\Omega} u(x) \,\mathrm{d}x = 0\). Then 
    \[
        \|u\|_{L^{p}} \leq C \|\nabla u\|_{L^{p}}
    \]   
}

\section{Compactness}
\begin{definition}{Sequential compactness}{}
    A metric space \((X, d)\) is compact if any sequence \(\{x_{n}\}_{n=1}^{\infty} \subset X\) has a convergent sub-sequence, i.e. there exists \(\{x_{n_{k}}\}_{k=1}^{\infty} \colon \lim\limits_{k \to \infty} x_{n_{k}} = x_0 \in X\).
\end{definition}

\begin{definition}{Compact}{}
    A topological space \(X\) is compact if any covering of \(X\) by open sets has a finite sub-covering.
\end{definition}

\begin{note}
    In metric spaces, compactness is equivalent to sequential compactness.

    In general topological spaces, they are not related.
\end{note}

\begin{theorem}{Hausdorff}{}
    Let \((X, d)\) be a metric space. Then \(X\) is compact \(\iff\) \(X\) is complete and totally bounded.
\end{theorem}

\begin{definition}{Totally bounded}{}
    \(X\) is totally bounded if \(\forall \epsilon > 0, \exists\) covering of \(X\) by finitely many \(\epsilon\)-balls, i.e. \(X = \bigcup_{k=1}^{N} B_{\epsilon}(x_k), N = N(\epsilon)\) and \(\{x_k\}\) is an \(\epsilon\)-net in \(X\).
\end{definition}

\subsection*{Why do we need compactness?}
Let \(X\) be compact and \(f \colon X \to Y \) be continuous, then \(f(X)\) is compact in Y. How do we solve PDEs of the form (or more general equations)?
\begin{equation}\label{eq:6}
    F(x) = 0
\end{equation}
\begin{enumerate}
    \item Construct approximate solutions
    
    \(F(x_n) = g_n\), where \(\lim\limits_{n \to \infty} g_n = 0\)
    \item Obtain a priori estimates, i.e. that \(\{x_n\}\) is bounded in a proper space
    \item If \(\{x_n\}\) is pre-compact and \(F\) is continuous \(\implies x = \lim\limits_{x \to \infty} x_{n_{k}}\) is a solution of \ref{eq:6}.
\end{enumerate}

\thm{Arzelà-Ascoli}
{
    Let \(\Omega \subset \mathbb{R}^{n}\) be a bounded domain. Then \(V \subset C(\bar{\Omega})\) is compact iff:
    \begin{enumerate}
        \item \(V\)  is closed
        \item \(V\) is bounded
        \item \(V\) is equicontinuous \(= V\) has a common modulus of continuity
    \end{enumerate} 
}

\thm{Arzelà-Ascoli for \(L^p\)}
{
    Let \(\Omega \subset \mathbb{R}^{n}\) be a bounded domain, (and \(\partial \Omega\) smooth, although not needed), \(K \subset L^{p}(\Omega), 1 \leq p < \infty\). Then \(K\) is compact iff:
    \begin{enumerate}
        \item \(K\) is closed
        \item \(K\) is bounded
        \item \(K\) is equicontinuous in mean (possesses a joint modulus of continuity in \(L^p\)).
    \end{enumerate} 
}

\begin{definition}{Modulus of continuity}{}
    Let \(f \in L^p(\Omega), 1 \leq p < \infty, \Omega \subset \mathbb{R}^{n}\) bounded (\(\partial \Omega\) smooth not needed). \(\omega \colon \mathbb{R}^{+} \to \mathbb{R}^{+}\) such that \(\lim\limits_{z \to 0} w(z) = 0\) is a modulus of continuity of \(f\) in \(L_{p}(\Omega)\) if 
    \[
        \int_{\Omega} \vert f(x+h) - f(x) \vert ^p \,\mathrm{d}x \leq \omega(\vert h \vert ), \quad \forall h \in \mathbb{R}^n,
    \]
    where we used the \(0\)-extension of \(f\) outside of \(\Omega\). 
\end{definition}

\begin{corollary}{}{1}
    Let \(K = B_{1}(0) \in W^{1, p}(\Omega); \Omega \subset \mathbb{R}^{n}\) is bounded, \(\partial \Omega\) is smooth, \(1 \leq p < \infty\). Then \(K\) is pre-compact in \(L^{p}(\Omega)\).
\end{corollary}

\begin{proof}
    We need to check equicontinuity, i.e. estimate \(\int_{\Omega} \vert f(x+h) - f(x) \vert ^p \,\mathrm{d}x \).
    \[
        f(x+h) - f(x) = h \int_{0}^{1} \nabla f(x + sh) \,\mathrm{d}s
    \]
    Taking modulus and \(p\)-th power of both sides, we get
    \[
        \vert f(x+h) - f(x) \vert ^p \leq \vert h \vert \int_{0}^{1} \vert \nabla f(x + sh) \vert ^p \,\mathrm{d}s 
    \]
    Finally, we take an integral over \(x \in \Omega\).
    \begin{align*}
        \int_{\Omega} \vert f(x+h) - f(x) \vert ^p \,\mathrm{d}x &\leq \vert h \vert \int_{0}^{1} \int_{\Omega} \vert \nabla f(x + sh) \vert ^p \,\mathrm{d}x \,\mathrm{d}s \\
        &\leq C \vert h \vert
    \end{align*}
    \(\omega(z) = cz\) is a joint modulus of continuity.
\end{proof}

\begin{definition}{Compact embedding}{}
        Let \(V \subset W\) be Banach spaces. Then the embedding is compact if the unit ball of \(V\) is pre-compact in \(W\).
\end{definition}

\begin{note}
    We proved that \(W^{1, p}(\Omega) \subset L^{p}(\Omega)\) is a compact embedding.
\end{note}

\cor{}
{
    \(W^{1, p}(\Omega) \subset L^{q}(\Omega)\) is a compact embedding if \(q < q^{*}\), where \(q^{*}\) is defined such that \(\frac{1}{q^{*}} = \frac{1}{p} - \frac{1}{n}\) and \(\Omega \subset  \mathbb{R}^{n}\), \(\Omega\) is bounded, \(\partial \Omega\) is smooth.
}

\begin{proof}
    Let us check equicontinuity. 
    \[
        \|f(\cdot + h) - f(\cdot)\|_{L^{q}} \leq \|f(\cdot + h) - f(\cdot)\|_{L^{p}}^{\theta} \|f(\cdot + h) - f(\cdot)\|_{L^{q^{*}}}^{1-\theta} 
    \]
    since \(p < q < q^{*}\) and \(0 < \theta < 1\). \(q^{*}\) is a critical exponent in Sobolev embeddings, indeed, \(W^{1, p}(\Omega) \subset L^{q}(\Omega) \implies 1-\frac{n}{p} \geq -\frac{1}{q}\). Then by corollary \ref{cor:1}, we have
    \begin{align*}
        \|f(\cdot + h) - f(\cdot)\|_{L^{p}}^{\theta} \|f(\cdot + h) - f(\cdot)\|_{L^{q^{*}}}^{1-\theta} &\leq C \vert h \vert ^{\theta}(2\|f\|_{L^{q^{*}}})^{1-\theta} \\
        &\leq C_1 \vert h \vert ^{\theta} \|f\|_{W^{1, p}}^{1-\theta} \\
        &\leq C_1 \vert h \vert ^{\theta}
    \end{align*}
\end{proof}

General fact: \(W^{s_1, p_1}(\Omega) \subset W^{s_2, p_2}(\Omega)\), where \(\Omega\) is bounded, \(\partial \Omega\) is smooth. Embedding is compact \(\iff\) embedding is not critical.

\section{Dual spaces}
\begin{definition}{Dual space}{1}
    \(W^{-s, p}(\Omega) \coloneqq \left(W^{s, q}_{0}(\Omega)\right)^{*}\) is defined as the dual space to \(W^{s, q}_{0}(\Omega) =\), i.e. the space of linear continuous functionals on \(W^{s, q}_{0}(\Omega)\), where \(\frac{1}{p} + \frac{1}{q} = 1\).
\end{definition}

\begin{definition}{}{2}
    \(W^{-s, p}(\Omega) = \left\{\text{completion of } L^{p}(\Omega) \text{ w.r.t } \|\ell\|_{W^{-s, p}} \coloneqq \sup\limits_{\varphi \in \mathcal{D}} \frac{\vert (\ell, \varphi) \vert }{\|\varphi\|_{W^{s, q}_{0}}} \right\} \) 
\end{definition}

\begin{definition}{}{3}
    \(W^{-s, p}(\Omega) = \left\{\ell \in \mathcal{D}'(\Omega) : \|\ell\|_{W^{-s, p}} \coloneqq \sup\limits_{\varphi \in \mathcal{D}} \frac{\vert\left\langle \ell, \varphi \right\rangle\vert}{\|\varphi\|_{W^{s, q}_{0}}} \right\} \)
\end{definition}

\mprop{}
{
    Definitions \ref{def:1}, \ref{def:2} and \ref{def:3} are equivalent.
}

\begin{question}{}{}
    Suppose \(\delta(x) \in W^{-s, p}(\Omega), \Omega \subset \mathbb{R}^{n}\). How are \(s, p\) and \(n\) related? We know that \(\delta(x)\) is well-defined on continuous functions, so we need \(W^{s, q}_{0}(\Omega) \subset C(\bar{\Omega})\).
\end{question}

\begin{example}{}{}
    Consider the case where \(n=1\) and \(p=2\). By the Sobolev embedding theorem, \(W^{s, 2} \subset C(\bar{\Omega})\) if \(0 < s - \frac{1}{2}\). 
    Thus we have \(\delta(x) \in H^{-s}(\Omega)\) if \(s>\frac{1}{2}\).
\end{example}

\chapter{Linear elliptic problems}
\section{Dirichlet and Neumann problems for the Laplacian}

\begin{example}{Laplace equation with Dirichlet boundary conditions}{}
    Let \(\Omega \in \mathbb{R}^{n}\) be a bounded domain with \(\partial \Omega\) smooth. Consider the Laplace equation with Dirichlet boundary conditions:
    \begin{equation}\label{eq:3.1}
        \begin{cases}
            \Delta u = f \\
            \left. u \right|_{\partial \Omega} = 0
        \end{cases}
    \end{equation}
    Typical questions: 
    \begin{enumerate}
        \item In what space does the solution live?
        \item In what sense is the equation understood (classical / weak)?
        \item In what sense are the boundary / initial data understood?
    \end{enumerate}
    In ODEs, we have local existence and uniqueness theorem (for Lipschitz non-linearities), but there is not an equivalent theorem for PDEs. Therefore, we must study particular examples.
\end{example}

\begin{definition}{}{}
    \(u \in W^{1, 2}_{0}(\Omega)\) is a weak solution of \ref{eq:3.1} if \(\forall \varphi \in C^{\infty}_{0}(\Omega)\),
    \begin{equation}\label{eq:3.2}
        - \int_{\Omega} \nabla u(x) \nabla \varphi(x) \,\mathrm{d}x = \ \int_{\Omega} f(x) \varphi(x) \,\mathrm{d}x
    \end{equation}
    Here, the boundary condition is incorporated into the choice of space \(W^{1, 2}_{0}(\Omega) = [C^{\infty}_{0}(\Omega)]_{W^{1, 2}(\Omega)}\) (the closure of \(C^{\infty}_{0}(\Omega)\) in the norm of \(W^{1, 2}(\Omega)\)). 

    \ref{eq:3.2} came from the integration by parts formula. Indeed, if \(u \in C^{2}(\Omega) \cap C(\bar{\Omega})\), then \(\Delta u = f\) is understood in a classical sense and
    \[
        \int_{\Omega} \Delta u \varphi \,\mathrm{d}x = - \int_{\Omega} \nabla u \nabla \varphi \,\mathrm{d}x + \int_{\partial\Omega} \partial_{n} u \varphi \,\mathrm{d}s,
    \]
    where the term \(\int_{\partial\Omega} \partial_{n} u \varphi \,\mathrm{d}s = 0\) because \(\left. \varphi \right|_{\partial \Omega} = 0\).
\end{definition}

\begin{theorem}{}{}
    Let \(f \in H^{-1}(\Omega) \coloneqq W^{-1, 2}(\Omega)\). Then \ref{eq:3.1} has a unique weak solution.
\end{theorem}

\begin{proof}{Application of Riesz representation theorem}

    \([u,u] \coloneqq \int_{\Omega} \nabla u \nabla u \,\mathrm{d}x\) is an equivalent norm on \(W^{1, 2}_{0}(\Omega)\) (due to Friedrich's inequality). Then \ref{eq:3.2} can be rewritten as
    \[
        [u, \varphi] = - \int_{\Omega} f(x)\varphi(x) \,\mathrm{d}x \coloneqq \ell(\varphi)
    \]

    Claim: \(\ell\) is a linear continuous functional on \(W^{1, 2}_{0}(\Omega)\) (the integral should be understood as duality if we take \(f \in H^{-1}(\Omega)\) and if \(f \in L^{2}(\Omega)\), this is a standard Lebesgue integral).

    Linearity of \(\ell\) is obvious. \(\ell\) is continuous as it is bounded:
    \[
        \vert \ell(\varphi) \vert \leq \|f\|_{H^{-1}} \| \varphi \|_{H^{1}}
    \]
    But we obtained that \ref{eq:3.2} holds only for \(\varphi \in C^{\infty}_{0}(\Omega)\), not for \(\varphi \in W^{1, 2}_{0}(\Omega)\). However, \(W^{1, 2}_{0}(\Omega) = [C^{\infty}_{0}(\Omega)]_{W^{1, 2}}\). Then approximation arguments give that \(\forall \varphi \in H\), 
    \begin{equation}\label{eq:3.3}
        [u, \varphi] = \ell(\varphi)
    \end{equation}
    Then by Riesz representation theorem, there exists a unique \(u \in W^{1, 2}_{0}(\Omega)\) which satisfies \ref{eq:3.3}.
\end{proof}

\begin{example}{Laplace equation with Neumann boundary conditions}{}
    Let \(\Omega \in \mathbb{R}^{n}\) be a bounded domain with \(\partial \Omega\) smooth. Consider the Laplace equation with Neumann boundary conditions:
    \begin{equation}\label{eq:3.4}
        \begin{cases}
            \Delta u = f \\
            \left. \partial_{n} u \right|_{\partial \Omega} = 0
        \end{cases}
    \end{equation}
    We cannot consider \(\varphi \in C^{\infty}_{0}(\Omega)\) as test functions, because the information about boundary conditions will be lost. Similarly, considering
    \[
        u \in W^{1, 2}_{n}(\Omega) \coloneqq \{u \in W^{1, 2}(\Omega) \colon \left. \partial_{n} u \right|_{\partial \Omega} = 0\}
    \]
    will not work as well, since \(\left. \partial_{n} u \right|_{\partial \Omega}\) is not defined for \(u \in W^{1, 2}(\Omega)\). Instead, let us take \(\varphi \in C^{\infty}(\bar{\Omega})\) as a test function and assume that \(u\) is a classical solution. Then
    \begin{align*}
        \int_{\Omega} f \varphi \,\mathrm{d}x &= \int_{\Omega} \Delta  u \varphi \,\mathrm{d}x \\
        &= - \int_{\Omega} \nabla u \nabla \varphi \,\mathrm{d}x + \int_{\partial \Omega} \partial_{n} u \varphi \,\mathrm{d}s \\
        &= - \int_{\Omega} \nabla u \nabla \varphi \,\mathrm{d}x ,
    \end{align*}
    as \(\int_{\partial \Omega} \partial_{n} u \varphi \,\mathrm{d}x = 0\) due to the boundary conditions. If we take \(\varphi(x) = 1\) as a test function, then we get
    \begin{align*}
        \int_{\Omega} f \cdot 1 \,\mathrm{d}x &= - \int_{\Omega} \nabla u \nabla 1 \,\mathrm{d}x \\
        &= 0
    \end{align*}
    Hence \(\left\langle f \right\rangle = \frac{1}{\vert \Omega \vert }\int_{\Omega} f(x) \,\mathrm{d}x = 0\) is a necessary condition for solvability.

    Let us notice that all solutions of this problem differs from each other by a constant. Thus, a natural assumption to single out the solution is \(\left\langle u \right\rangle = 0\). 
\end{example}

\begin{definition}{}{}
    \(u \in W^{1, 2}(\Omega) \cap \{\left\langle u \right\rangle = 0\}\) is a weak solution of \ref{eq:3.4} if \(\forall \varphi \in C^{\infty}(\bar{\Omega})\), we have:
    \begin{equation}\label{eq:3.5}
        \int_{\Omega} \nabla u \nabla \varphi \,\mathrm{d}x = - \int_{\Omega} f \varphi \,\mathrm{d}x
    \end{equation}

\end{definition}

\begin{note}
    The boundary conditions are now not in the definition of the space, but in \ref{eq:3.5}.
\end{note}

\begin{theorem}{}{}
    Let \(f \in L^{2}(\Omega) \cap \{\left\langle f \right\rangle = 0\}\). Then \ref{eq:3.4} has a unique weak solution. 
\end{theorem}

\begin{proof}
    The proof is analogous to the problem with Dirichlet boundary conditions, but instead of applying Friedrich's inequality, we should apply Poincaré's inequality and use density of \(C^{\infty}(\Omega) \in W^{1, 2}(\Omega)\). 
\end{proof}

\begin{example}{Non-homogeneous Neumann boundary conditions}{}
    Let \(\Omega \in \mathbb{R}^{n}\) be a bounded domain with \(\partial \Omega\) smooth. Consider the Laplace equation with non-homogeneous Neumann boundary conditions:
    \begin{equation}\label{eq:3.6}
        \begin{cases}
            \Delta u = f \\
            \left. \partial_{n} u \right|_{\partial \Omega} = g
        \end{cases}
    \end{equation}
\end{example}

\begin{definition}{}{}
    \(u \in W^{1, 2}(\Omega) \cap \{\left\langle u \right\rangle = 0\}\) is a weak solution of \ref{eq:3.6} if \(\forall \varphi \in C^{\infty}(\bar{\Omega})\), we have:
    \begin{equation}\label{eq:3.7}
        \int_{\Omega} \nabla u \nabla \varphi \,\mathrm{d}x = - \int_{\Omega} f \varphi \,\mathrm{d}x + \int_{\partial\Omega} g\varphi \,\mathrm{d}s
    \end{equation}
    Note that if \(\varphi \equiv 1\), then a necessary condition for solvability is
    \[
        - \int_{\Omega} f \,\mathrm{d}x + \int_{\partial\Omega} g \,\mathrm{d}s = 0
    \]
\end{definition}

\begin{theorem}{}{}
    Let \(f \in L^{2}(\Omega), g \in W^{-\frac{1}{2}, 2}(\partial \Omega)\) be such that \(\int_{\Omega} f \,\mathrm{d}x = \int_{\partial\Omega} g \,\mathrm{d}s\). Then \ref{eq:3.6} has a unique weak solution.  
\end{theorem}

\begin{proof}
    \([u, u] \coloneqq \int_{\Omega} \nabla u \nabla u ds\) is an equivalent norm on \(u \in W^{1, 2}(\Omega) \cap \{\left\langle u \right\rangle = 0\}\) due to the Poincaré inequality. Then \ref{eq:3.7} can be rewritten as
    \[
        [u, \varphi] = \ell(\varphi) \coloneqq - \int_{\Omega} f\varphi\,\mathrm{d}x + \int_{\partial\Omega} g\varphi\,\mathrm{d}s
    \]
    We claim that \(\ell\) is a linear continuous functional on \(W^{1, 2}(\Omega) \cap \{\left\langle u \right\rangle = 0\}\). Indeed, linearity is obvious. To show \(\ell\) is  continuous, we have
    \begin{align*}
        \left\vert - \int_{\Omega} f\varphi\,\mathrm{d}x + \int_{\partial\Omega} g\varphi\,\mathrm{d}s \right\vert &\leq \|f\|_{L^{2}} \|\varphi\|_{L^{2}} + \|g\|_{H^{-\frac{1}{2}}(\partial \Omega)}\|\varphi\|_{H^{\frac{1}{2}}(\partial \Omega)} \\
        \text{(By the trace theorem and Poincaré's inequality)} &\leq \|f\|_{L^{2}} \|\varphi\|_{W^{1, 2}(\Omega)} + \|g\|_{H^{-\frac{1}{2}}(\partial \Omega)}\|\varphi\|_{W^{1, 2}(\Omega)}  
    \end{align*}

Then by Riesz representation theorem, there exists a unique \(u \in W^{1, 2}(\Omega) \cap \{\left\langle u \right\rangle = 0\}\) that is a weak solution of \ref{eq:3.6}.
\end{proof}

\begin{example}{Non-homogeneous Dirichlet boundary conditions}{}
    Let \(\Omega \in \mathbb{R}^{n}\) be a bounded domain with \(\partial \Omega\) smooth. Consider the Laplace equation with non-homogeneous Dirichlet boundary conditions:
    \begin{equation}\label{eq:3.8}
        \begin{cases}
            \Delta u = 0 \\
            \left. u \right|_{\partial \Omega} = g
        \end{cases}
    \end{equation}
    Let us take \(g \in W^{\frac{1}{2}, 2}(\partial \Omega)\). Then there exists \(v \in W^{1, 2}(\Omega)\) such that \(\left. v \right|_{\partial \Omega} = g\) (by the trace theorem). We look for the solution of \ref{eq:3.8} in the form \(u = v + w\), where \(w \in W^{1, 2}_{0}(\Omega)\).
\end{example}

\begin{definition}{}{}
    \(u = v + w\) is a weak solution of \ref{eq:3.8} if \(\left. v \right|_{\partial \Omega} = g\), where \(g \in W^{\frac{1}{2}, 2}(\partial \Omega), w \in W^{1, 2}_{0}(\Omega)\) and \(\forall \varphi \in C^{\infty}(\bar{\Omega})\), we have 
    \begin{equation}\label{eq:3.9}
        \int_{\Omega} \nabla (v+w) \nabla \varphi \,\mathrm{d}x = 0
    \end{equation}    
\end{definition}

\begin{theorem}{}{}
    Let \(g \in W^{\frac{1}{2}, 2}(\partial \Omega)\). Then \ref{eq:3.8} has a unique weak solution.
\end{theorem}

\begin{proof}
    We can rearrange \ref{eq:3.9} to get
    \[
        \ell(\varphi) \coloneqq -[v, \varphi] = \int_{\Omega} \nabla w \nabla \varphi \,\mathrm{d}x = [w, \varphi],
    \]
    and the functional \(\ell\) can be shown to be linear and continuous. By the Riesz representation theorem, there exists a unique \(w \in W^{1, 2}(\Omega)\) such that \ref{eq:3.9} is satisfied. Note that this \(w\) depends on the choice of \(v\). But \(u = v + w\) does not depend on the choice of \(v\). Indeed, let \(u_1\) and \(u_2\) be two solutions of \ref{eq:3.8}. Then \(u = u_1 - u_2\) solves
    \[
        \begin{cases}
            \Delta u = 0 \\
            \left. u \right|_{\partial \Omega} = 0
        \end{cases}
    \]
    We have previously shown that the weak solution of this problem is unique. Therefore, \(u_1 = u_2\). 
\end{proof}

\begin{note}
    There is no universal choice of the space of test functions. Even for Dirichlet and Neumann boundary conditions, we need to consider different spaces. \(\varphi \in C^{\infty}_{0}(\Omega)\) corresponds to the standard theory of distributions, while \(\varphi \in C^{\infty}(\bar{\Omega})\) corresponds to ``non-standard'' distributions.
\end{note}

\begin{example}{}{}
    Let \(\Omega \in \mathbb{R}^{n}\) be a bounded domain with \(\partial \Omega\) smooth. Consider
    \begin{equation}\label{eq:3.10}
        \begin{cases}
            \sum_{i, j} \partial_{x_{i}}(a_{ij}(x)\partial_{x_{j}}u) = g \\
            \left. u \right|_{\partial \Omega} = 0
        \end{cases}
    \end{equation}
    Where we make the following assumptions on the matrix \(a(x) \coloneqq \{a_{ij}(x)\}_{i,j}\):
    \begin{enumerate}
        \item \(a(x)\) is a symmetric matrix for every \(x\): 
        \[a_{ij}(x) = a_{ji}(x)\]
        \item \(a(x)\) is uniformly elliptic. That is, for all \(\xi \in \mathbb{R}^{n}\), there exists \(\mu, M > 0\) which are independent of \(x\) such that
        \[
            \mu \vert \xi^{2} \vert \leq \sum_{i,j} a_{ij} \xi_{i} \xi_{j} \leq M \vert \xi^{2} \vert 
        \]
    \end{enumerate} 
\end{example}

\begin{definition}{}{}
    \(u \in W^{1, 2}_{0}(\Omega)\) is a weak solution to \ref{eq:3.10} \(\iff \forall \varphi \in C^{\infty}_{0}(\Omega)\), we have 
    \[
        \sum_{i,j} \int_{\Omega} a_{ij} \partial_{x_{j}} u \partial_{x_{i}} \varphi \,\mathrm{d}x = -\int_{\Omega} g\varphi \,\mathrm{d}x
    \]
\end{definition}

\begin{theorem}{}{}
    Let \(a(x)\) be symmetric and uniformly elliptic. Then \ref{eq:3.10} has a unique weak solution.
\end{theorem}

\begin{proof}
    Let us denote
    \[
        [u, \varphi]_{a} = \int_{\Omega} \sum_{i,j} a_{ij}(x) \partial_{x_{j}} u(x) \partial_{x_{i}} \varphi(x) \,\mathrm{d}x.
    \]
    Then since \(a(x)\) is symmetric, the bilinear form \([u, v]_{a}\) is also symmetric, i.e. \([u, v]_{a} = [v, u]_{a}\). Since \(a(x)\) is uniformly elliptic, there exist \(\mu, M > 0\) such that
    \[
        \mu[u, u] \leq [u, u]_{a} \leq M[u, u].
    \]
    Therefore, \(\left(W^{1, 2}_{0}(\Omega), [\cdot, \cdot]_{a}\right)\) is a Hilbert space with the norm equivalent to the standard \(W^{1, 2}_{0}(\Omega)\) norm.

    By the Riesz representation theorem, there exists a unique weak solution to \ref{eq:3.10}.
\end{proof}

\section{More general problems via Lax-Milgram}
By the Riesz representation theorem, for any linear continuous functional, \(\ell\) on a Hilbert space \(H\), there exists a unique \(x \in H\) such that \(\forall \varphi \in  H\), we have \((x, \varphi) = \ell(\varphi)\).

If we want \(a(x, y)\) to be an equivalent inner product on \(H\), then \(a(x, y)\) must be symmetric.

We now consider the case where \(a(x, y)\) is not assumed to be symmetric.

\begin{definition}{Bilinear form}{}
    A bilinear form \(a(\cdot, \cdot) \colon H \times H \rightarrow \mathbb{R}\) is bounded if 
    \[
        \vert a(x, y) \vert \leq C \|x\|\|y\|
    \]
\end{definition}

\begin{definition}{Coercive}{}
    A bilinear form \(a(\cdot, \cdot)\) is coercive if \(\exists \alpha > 0\) such that \(a(x, x) \geq \alpha\|x\|^{2}\). 
\end{definition}

\begin{theorem}{}{}
    Let \(a(x, y)\) be a bounded and coercive bilinear form on \(H\). Then any linear continuous functional \(\ell \colon H \to \mathbb{R}\) can be represented in the form
    \begin{equation}\label{eq:3.11}
        a(x, y) = \ell(\varphi), \quad \forall \varphi \in H.
    \end{equation}
    i.e. \(\forall \ell \in H^{*}\), there exists a unique \(x = x(\ell) \in H\) such that \ref{eq:3.11} is satisfied.
\end{theorem}

\begin{example}{}{}
    Let \(\Omega \in \mathbb{R}^{n}\) be a bounded domain with \(\partial \Omega\) smooth. Consider the problem
    \begin{equation}\label{eq:3.12}
        \begin{cases}
            \sum_{i, j} \partial_{x_{i}}(a_{ij}(x)\partial_{x_{j}}u) + \sum_{i}b_{i}(x) \partial_{x_{i}}u = g(x) \\
            \left. u \right|_{\partial \Omega} = 0
        \end{cases}
    \end{equation}
\end{example}

\begin{definition}{}{}
    \(u \in W^{1, 2}_{0}(\Omega)\) is a weak solution of \ref{eq:3.12} if \(\forall \varphi \in C^{\infty}_{0}(\Omega)\), we have 
    \[
        A(u, \varphi) \coloneqq \sum_{i, j} \int_{\Omega} a_{ij}(x) \partial_{x_{j}}u \partial_{x_{i}}\varphi \,\mathrm{d}x - \sum_{i} \int_{\Omega} b_{i}(x) \partial_{x_{i}} u \varphi \,\mathrm{d}x = \ell(\varphi) \coloneqq - \int_{\Omega} g(x)\varphi(x) \,\mathrm{d}x
    \]
\end{definition}

\begin{theorem}{}{}
    Let \(\{a_{ij}\} \in L^{\infty}(\Omega)\) be a uniformly elliptic matrix, \(b_{i}(x)\) be a smooth divergent free vector field and \(g(x) \in H^{-1}(\Omega)\). Then \ref{eq:3.12} has a unique weak solution.
\end{theorem}

\begin{proof}
    We use the Lax-Milgram theorem. We know that \(\ell(\varphi)\) is a linear continuous functional on \(W^{1, 2}_{0}(\Omega)\). Furthermore, \(A(u, \varphi)\) is bilinear and bounded. Indeed, by Friedrich's inequality, we have
    \[
        \vert A(u, \varphi) \vert \leq C_{1}\|\nabla u\|_{L^{2}} \|\nabla \varphi\|_{L^{2}} + C_2\|\nabla u\|_{L^{2}}\|\varphi\|_{L^{2}} \leq C\|u\|_{W^{1, 2}_{0}(\Omega)}\|\varphi\|_{W^{1, 2}_{0}(\Omega)}
    \]
    \(A(u, \varphi)\) is coercive since 
    \begin{align*}
        A(u, u) &= \sum_{i, j} \int_{\Omega} a_{ij} \partial_{x_{j}}u \partial_{x_{i}}u \,\mathrm{d}x - \sum_{i} \int_{\Omega} b_{i}(x) \partial_{x_{i}} (u) u \,\mathrm{d}x \\
        &\geq \alpha \|\nabla u\|_{L^{2}}^{2} - \frac{1}{2}\int_{\Omega} \sum_{i} b_{i}(x) \partial_{x_{i}} (u^{2}) \,\mathrm{d}x \\
        &= \alpha \|\nabla u\|_{L^{2}}^{2} + \frac{1}{2} \int_{\Omega} \text{div}b \cdot u^{2}(x) \,\mathrm{d}x \\
        &= \alpha\|\nabla u\|_{L^{2}}^{2}
    \end{align*}
    By the Lax-Milgram theorem, there exists a unique weak solution of \ref{eq:3.12}.
\end{proof}

\section{Introduction to spectral theory}
\(H\) is a Hilbert space. \(\mathcal{L}(H)\) is a space of linear continuous operators.

\begin{lemma}{}{}
    \(A\) is continuous \(\iff\) A is bounded, i.e.
    \[
        \|A\| \coloneqq  \sup_{x \in H} \frac{\|Ax\|}{\|x\|} < \infty
    \]
\end{lemma}

\begin{lemma}{}{}
    \((\mathcal{L}(H), \|\cdot\|)\) is a Banach space. 
\end{lemma}

\begin{definition}{Invertible operator}{}
    \(A\) is invertible \(\iff \exists A^{-1} \in \mathcal{L}(H)\) such that
    \begin{equation}\label{eq:3.13}
        AA^{-1} = A^{-1}A = I
    \end{equation}
\end{definition}

\begin{definition}{Spectrum}{}
    \(\lambda \in \sigma(A)\) (the spectrum of \(A\)) \(\iff\) \(\lambda I - A\) is not invertible.

    In other words, \(\lambda \notin \sigma(A)\), (\(\lambda\) is in the resolvent set) iff the equation \(\lambda u - Au = f\) has a unique solution for all \(f \in H\).
\end{definition}

\begin{note}
    If \(\dim H = n < \infty\), then \(\mathcal{L}(H) = M(n \times n)\) (\(n \times n\) matrices) and
    \begin{enumerate}
        \item All linear operators are continuous,
        \item All \(\lambda\in \sigma(A)\) correspond to eigenvalues
        \[
            A \rho_{\lambda} = \lambda \rho_{\lambda} \implies \sigma(A) = \sigma_{p}(A)\text{ (point spectrum).}
        \]
        \item \(\lambda \in \sigma(A) \iff \det(\lambda I - A) = 0\)
        \item Only one of two equalities from \ref{eq:3.13} holding is enough. 
    \end{enumerate}
    All of the statements may fail when \(\dim H = \infty\).
\end{note}

\begin{example}{}{}
    Let \(H = \ell_{2}\), the space of square summable sequences. Let \(T_{r}, T_{l} \in \mathcal{L}(H)\) denote the right and left shift operators, respectively;
    \begin{align*}
        T_{r}(x_1, x_2, x_3, \dots) &= (0, x_1, x_2, x_3, \dots) \\
        T_{l}(x_1, x_2, x_3, \dots) &= (x_2, x_3, \dots)
    \end{align*}
    Then \(T_{l} \circ T_{r} = I\), but \(T_{r} \circ T_{l} (x) = (0, x_2, x_3, \dots)\). Hence \(T_{r}\) has a left inverse, but not a right inverse. \(\ker(T_{r}) = \{0\}\), i.e. it is injective (no eigenvalues), but the range of \(T_{r} \neq H\), since \(T_{r}(x) \perp e_{1}\) for any \(x \in H\). So \(T_{r}\) is not invertible since \(T_{r}(H)\) is a proper closed subspace of \(H\). Therefore, a new type of spectrum appeared - the residual spectrum \(\sigma_{R}(A)\), which is impossible in finite-dimensional spaces. 

    Also, the determinant does not exist in infinite-dimensional spaces. Indeed, if it existed, then
    \[
        1 = \det(T_{l} \circ T_{r}) = \det(T_{l})\det(T_{r}),
    \]
    which implies that both \(T_{l}\) and \(T_{r}\) are invertible, but this is not true.
\end{example}

\begin{definition}{Approximate point spectrum}{}
    \(\lambda \in \sigma_{\text{app}}(A)\) (approximate point spectrum) \(\iff \exists x_{n} \in H, \|x_{n}\| = 1\) and \(\lim\limits_{n \rightarrow \infty} (Ax_{n}-\lambda x_{n}) = 0\).

    It can be proved that \(\lambda \in \sigma_{\text{app}}(A) \iff \) the image of \((\lambda I - H)\) is not closed.
\end{definition}

\begin{example}{}{}
    \(H = L^{2}(0, 1), Af(x) \coloneqq xf(x)\).
    \[
        \lambda u - Au = f \iff (\lambda - x)u(x) = f(x),
    \]
    then \(u(x) = \frac{f(x)}{\lambda - x}\) and \((A - \lambda I)\) is not invertible \(\iff \lambda \in [0, 1]\). Hence, \(\sigma(A) = [0, 1]\).

    We can check that Range(\(\lambda I - A\)) is not closed if \(\lambda \in [0, 1]\).
\end{example}
The next theorem shows that these are all the possible obstacles to invert the operator.

\begin{theorem}{Weyl's theorem}{}
    \(A \in \mathcal{L}(H)\). Then \(\sigma(A) = \sigma_{p}(A) \cup \sigma_{\text{app}}(A) \cup \sigma_{R}(A)\).
\end{theorem}

\begin{definition}{Resolvent}{}
    \(R_{A}(\lambda) := (\lambda I - A)^{-1}\) is called the resolvent of \(A \in \mathcal{L}(H)\).
\end{definition}

More standard facts:
\begin{enumerate}
    \item If \(\vert \lambda \vert > \|A\|\), then \(\lambda \in \sigma(A)\). Indeed, 
    \[
        \frac{1}{\lambda - A} = \frac{1}{\lambda} \frac{1}{1-\frac{A}{\lambda}} = \frac{1}{\lambda} \sum_{n=0}^{\infty} \left(\frac{A}{n}\right)^{n}
    \]
    is an absolutely convergent series if \(\vert \lambda \vert  > \|A\| \).
    \item Resolvent identity:
    \begin{equation}\label{eq:3.14}
        R_{A}(\lambda) - R_{A}(\mu) = -(\lambda - \mu)R_{A}(\lambda)R_{A}(\mu),
    \end{equation}
    which follows from 
    \[
        \frac{1}{\lambda - x} - \frac{1}{\lambda - \mu} = (\mu - \lambda) \frac{1}{\lambda - x} \frac{1}{\mu - x},
    \]
    where we substitute in \(x = A\).
    From \ref{eq:3.14}, by taking the limit as \(\mu \to \lambda\), we get
    \[
        \frac{d}{d \lambda} R_{A}(\lambda) = -R_{A}(\lambda)^{2}.
    \]
    Hence \(R_{A}(\lambda)\) is an analytic function of \(\lambda\).
    \item By Liouville's theorem applied to \(R_{A}(\lambda), \sigma(A) \neq \emptyset\)
\end{enumerate}

\begin{definition}{Compact operator}{}
    \(A \in \mathcal{L}(H)\) is compact \(\iff AB_{1}(0)\) is a precompact set in \(H\).
\end{definition}

\begin{definition}{Adjoint operator}{}
    Let \(A \in  \mathcal{L}(H)\). The adjoint operator \(A^{*} \in \mathcal{L}(H)\) is defined via \((Ax, y) = (x, A^{*}y), \quad \forall x, y \in H\).
    It exists due to Riesz representation theorem. In the finite dimensional case, the adjoint operator coincides with the transpose operator.
\end{definition}

\begin{definition}{Self-adjoint operator}{}
    \(A \in \mathcal{L}(H)\) is self-adjoint if \(A = A^{*}\) 
\end{definition}

\begin{definition}{Fredholm}{}
    \(A \in \mathcal{L}(H)\) is Fredholm if Range(\(A\)) and Range(\(A^{*}\)) are closed and \(\ker(A)\) and \(\ker(A^{*})\) are both finite dimensional.

    Then the index of \(A\) is defined by 
    \[
        \text{ind}(A) \coloneqq \dim \ker(A) - \dim \ker(A^{*})
    \]
\end{definition}

\begin{theorem}{Key theorem of Fredholm operators theorem}{}
    \(\text{ind}(A)\) is a topological invariant. Namely, if \(A(t), t \in [0, 1]\) is a continuous curve of Fredholm operators, then 
    \[
        \text{ind}(A(0)) = \text{ind}(A(1)).
    \]
\end{theorem}

\begin{definition}{Essential spectrum}{}
    \(\lambda \in \sigma_{\text{ess}}(A)\) if \(\lambda I - A\) is not Fredholm.
\end{definition}

Properties:
\begin{enumerate}
    \item \(K\) is compact \(\iff K^{*}\) is compact.
    \item \(A \in \mathcal{L}(H), K \) compact \(\implies AK\) and \(KA\) are compact.
    \item \(A\) is Fredholm \(\iff A^{*}\) is Fredholm.
    \item Fredholm alternative: Let \(A\) be Fredholm. Then:
    \begin{align*}
        H &= \text{Range}(A) \oplus \ker(A^{*}) \\
        H &= \text{Range}(A^{*}) \oplus \ker(A)
    \end{align*}
    \item \(A\) is Fredholm \(\iff\) it is invertible by modulus of compact operators, i.e. \(\exists B : AB = I + K_{1}, BA = I + K_{2}\), with \(K_1, K_2\) compact.
    \item Let \(K\) be a compact operator. Then \(\sigma_{\text{ess}}(K) = 0\) and for any \(\varepsilon > 0, \sigma(K) \setminus B_{\varepsilon}(0)\) consists of finitely many eigenvalues of finite multiplicity.
    \item If \(A = A^{*}\), then \(\sigma(A)\) is real and \(\sigma_{R}(A) = \emptyset\).
\end{enumerate}
Thus, the simplest case is the case of positive, compact and self-adjoint operators.

\begin{theorem}{Hilbert-Schmidt}{}
    Let \(A \in \mathcal{L}(H)\) be a compact, self-adjoint and positive (\((Ax, x) > 0\) if \(x \neq 0\)) operator. Then there exists a sequence of non-zero real eigenvalues \(\lambda_{i} \in \sigma_{p}(A)\) such that \(\vert \lambda_{i} \vert \) is monotonically non-increasing
    \[
        \lambda_{1} \geq \lambda_{2} \geq \lambda_{3} \geq \dots,
    \]
    and the corresponding eigenvectors \(\{e_{n}\}_{n=1}^{\infty} (Ae_{n} = \lambda e_{n})\) form the orthonormal basis in \(H\).

    Moreover, any \(x \in H\) can be written as
    \[
        x = \sum_{n=1}^{\infty} \left\langle x, e_{n} \right\rangle e_{n},
    \]
    and \(A\) can be written as
    \[
        Ax = \sum_{n=1}^{\infty} \lambda_{n} \left\langle x, e_{n} \right\rangle e_{n}.
    \]
\end{theorem}

\subsection*{Applications}
\begin{example}{Spectrum of the Laplacian with Dirichlet boundary conditions}{}
    Let \(\Omega \in \mathbb{R}^{n}\) be a bounded domain with \(\partial \Omega\) smooth. Consider the Laplace equation with Dirichlet boundary conditions:
    \begin{equation*}
        \begin{cases}
            - \Delta u = f, \qquad f \in L^{2}(\Omega) \\
            \left. u \right|_{\partial \Omega} = 0
        \end{cases}
    \end{equation*}

    \(- \Delta\) is not a bounded operator in \(H \coloneqq L^{2}(\Omega)\), so we cannot apply directly apply the Hilbert-Schmidt theorem.

    Let us consider the inverse operator \(A = (- \Delta)^{-1}\) constructed via weak solutions, namely \(u = (- \Delta)^{-1}f = Af\) solves \([u, \varphi] = (f, \varphi)\). That is, \(\forall \varphi \in C^{\infty}_{0}(\Omega)\) (or \(H^{1}_{0}\)) and \(u \in H^{1}_{0}(\Omega)\), we have
    \[
        \int_{\Omega} \nabla u \nabla \varphi \,\mathrm{d}x = \int_{\Omega} f \varphi \,\mathrm{d}x
    \]

    \begin{enumerate}
        \item \(A\) is a bounded operator from \(H\) to \(H^{1}_{0}(\Omega)\). Indeed, let \(\varphi = u\). Then
        \begin{align*}
            \|u\|_{H^{1}_{0}}^{2} &= (f, u) \\
            &\leq \|f\|_{L^{2}}\|u\|_{L^{2}} \\
            &\leq C\|f\|_{L^{2}}\|u\|_{H^{1}_{0}}
        \end{align*}
        Hence 
        \[
            \|u\|_{H^{1}_{0}} \leq C \|f\|_{L^{2}} \implies \frac{\|Af\|_{H^{1}_{0}}}{\|f\|_{L^{2}}} \leq C
        \]
        \item \(A\) is compact since the embedding \(H^{1}_{0} \subset H\) is compact.
        \item \(A\) is self-adjoint. Let \(f, g \in L^{2}(\Omega), u = (- \Delta)^{-1}f, v = (- \Delta)^{-1}g\). Take \(\varphi = v\) in variational formulation for \(u\), and \(\varphi = u\) in variational formulation for \(v\):
        \begin{align*}
            [u, v] &= (f, v) \\
            [u, v] &= (g, u) \\
            \implies (f, v) &= (g, u) \implies (f, Ag) = (g, A^{*}f) \implies A = A^{*}
        \end{align*}
        \item \(A\) is positive.
        \[
            0 < [u, u] = (f, u) = (f, Af)
        \]    
    \end{enumerate}
    By the Hilbert-Schmidt theorem, there exists a complete orthonormal system \(\{e_{n}\}\) of eigenvectors of \(A\) with \(Ae_{n} = \lambda e_{n}\). 
        
    \(e_{n}\) by definition solves \(\lambda_{n}[e_{n}, \varphi_{n}] = (e_{n}, \varphi)\). Indeed, for \(u_{n} = Ae_{n}\), we have \([u_{n}, \varphi] = (e_{n}, \varphi)\). Since \(u_{n} = \lambda_{n}e_{n}\), this implies that 
    \begin{equation}\label{eq:3.15}
        [e_{n}, \varphi] = \lambda_{n}^{-1}(e_{n}, \varphi).
    \end{equation}
    Hence \(e_{n}\) is a weak solution of
    \begin{equation*}
        \begin{cases}
            - \Delta e_{n} = \lambda_{n}^{-1}e_{n} \\
            \left. e_{n} \right|_{\partial \Omega} = 0
        \end{cases}
    \end{equation*}
\end{example}

Consider the minimisation problem:
\[
    \min\limits_{u \in H^{1}_{0}(\Omega)}\|\nabla u\|_{L^{2}}^{2}
\]
under the constraint \(\|u\|_{L^{2}}^{2} = 1\). Let \(u_{n}\) be a minimising sequence with \(\|u_{n}\|_{L^{2}}^{2} = 1\) and \(\|\nabla u_{n}\|_{L^{2}}^{2} \to \lambda_{0}\). We want to prove that \(\lambda_{0}\) is the minimum of \(u\). We need to prove the existence of the minimiser and to find \(\lambda_{0}\).

\begin{enumerate}
    \item \(u_{n}\) is bounded in \(H^{1}_{0}(\Omega)\). \(H^{1}_{0}(\Omega) \Subset L^{2}(\Omega)\) is compactly embedded, so it converges strongly to \(u_{0}\) in \(L^{2}(\Omega)\). Also, since \(\nabla u\) is bounded, by Banach-Alaoglu theorem and reflexivity, \(u_{n} \rightharpoonup u_{0}\) weakly in \(H^{1}_{0}\) (up to a subsequence) and \(\|\nabla u_{0}\|_{L^{2}} \leq \lim\limits_{n \to \infty} \inf \|\nabla u_{n}\|_{L^{2}} = \lambda_{0}\). Since \(\lambda_{0}\) is an infimum, then \(\|\nabla u_{0}\|_{L^{2}} = \lambda_{0}\). Thus \(u_{0}\) is a minimiser.
    \item Let use the Euler-Lagrange method.
    \[
        L_{\lambda}(u) = \|\nabla u\|_{L^{2}}^{2} + \lambda\|u\|_{L^{2}}
    \]
    Let \(\varphi\) be an arbitrary (smooth) function and define \(R_{\varphi}(\varepsilon) \coloneqq L_{\lambda}(u + \varepsilon\varphi), \varepsilon \in \mathbb{R}\). Then the necessary condition for \(u\) to be a minimum of \(L\) is
    \[
        \frac{d}{d\varepsilon} \left. R_{\varphi}(\varepsilon) \right|_{\varepsilon = 0} = 0, \qquad \forall \varphi.
    \]
    \begin{align*}
        L_{\lambda}(u + \varepsilon\varphi) &= \|\nabla (u + \varepsilon\varphi)\|_{L^{2}}^{2} + \lambda\|u + \varepsilon\varphi\|_{L^{2}}^{2} \\
        &= \|\nabla u\|_{L^{2}}^{2} + 2\varepsilon(\nabla u, \nabla \varphi) + \varepsilon^{2}\|\nabla \varphi\|_{L^{2}}^2 + \lambda\|u\|_{L^{2}}^{2} + 2\varepsilon \lambda(u, \varphi) + \varepsilon^{2}\|\varphi\|_{L^{2}}^{2}
    \end{align*}
    Hence \(u\) is a minimiser of \(L\) if \(\forall \varphi \in H^{1}_{0}\), we have 
    \[
       (\nabla u, \nabla \varphi) + \lambda(u, \varphi) = 0.
    \]
    Comparing this equality with \ref{eq:3.15}, we see that \(u = u_{0}\) is the eigenvector of \((-\Delta)^{-1}\) and \(-\lambda^{-1}\) is the corresponding eigenvalue (in this notation, \(-\lambda > 0\)). Equivalently, \(u_{0}\) is the eigenvector of \(-\Delta\) and \(-\lambda\) is the corresponding eigenvalue. From the Hilbert-Schmidt theorem, we know that
    \begin{equation}\label{eq:3.16}
        -\frac{1}{\lambda_{1}} \geq -\frac{1}{\lambda_{2}} \geq -\frac{1}{\lambda_{3}} \geq \dots -\frac{1}{\lambda_{i}},
    \end{equation}
    where \(-\frac{1}{\lambda_{i}}\) are eigenvalues of \((-\Delta)^{-1}\). From \ref{eq:3.15} and \ref{eq:3.16}, the minimal eigenvalue is \(-\lambda_{1}\).
    
    Taking \(\varphi = u\), we get \(\|\nabla u\|_{L^{2}}^{2} + \lambda\|u\|_{L^{2}}^{2} = 0\), and if \(u = e_{1}\), then 
    \[
        \|\nabla e_{1}\|_{L^{2}}^{2} - \lambda_{1}\|e_{1}\|_{L^{2}}^{2} = 0 
    \]
    and for any other \(u\),
    \[
        \|\nabla u\|_{L^{2}}^{2} - \lambda_{1}\|u\|_{L^{2}}^{2} > 0 
    \] 
    Hence for all \(u \in H^{1}_{0}(\Omega)\),
    \[
        \|u\|_{L^{2}}^{2} \leq \frac{1}{\lambda_{1}} \|\nabla u\|_{L^{2}}^{2}.
    \]
    This also shows that \(\frac{1}{\lambda_{1}}\) is the sharp constant in Friedrich's inequality.
\end{enumerate}

\section{Maximum principle}
\begin{theorem}{Classical maximum principle}{}
    Let \(u \in C^{2}(\Omega) \cap C(\bar{\Omega})\), where \(\Omega \subset \mathbb{R}^{n}\) is a bounded domain, and \(\Delta u = 0\). Then
    \[
        \max\limits_{x \in \partial \Omega} u(x) \geq u(x) \geq \min\limits_{x \in \partial \Omega} u(x)
    \]
    In other words, the maximum and minimum of a harmonic function is attained on the boundary.
\end{theorem}

\begin{proof}
    Let us prove the max-inequality. Let \(v = u + \varepsilon e^{x_{1}}\). Then \(\nabla v = \varepsilon e^{x_{1}}, \varepsilon > 0\). Assume that the maximum is attained in the interior point \(x_{0} \in \Omega\). Then \(\nabla u(x_{0}) = 0\), and the matrix of second derivatives must be non-positive. In particular, tr\((D^{2}u(x_{0})) = \Delta v(x_{0}) \leq 0\), which implies that \(\varepsilon e^{x_{1}} < 0\), a contradiction. Therefore, the maximum \(v\) is attained on the boundary. Taking the limit as \(\varepsilon \to 0\), the same is true for \(u\) (but due to the limit, the inequalities become non-strict). The proof is analogous for the min-inequality.
\end{proof}
This formulation does not exclude that the maximum \(u\) may be attained inside \(\Omega\). However, the strong-maximum principle claims that if the maximum or minimum of \(u\) is attained inside \(\Omega\), then \(u\) is constant.

\subsection*{Maximum principle for weak solutions}

\subsubsection*{Chain rule in Sobolev spaces}
For smooth functions \(f\) and \(u\), we know that 
\begin{equation}\label{eq:3.17}
    \nabla f(u(x)) = f'(u(x))\nabla u
\end{equation}
Let \(f \in C^{1}(\Omega)\) and \(\nabla f\) be bounded, and \(u \in W^{1, p}(\Omega)\). Then the LHS and RHS of \ref{eq:3.17} are well-defined and by approximation (\(\Omega\) is regular enough to have density of \(C^{\infty}(\Omega) \in W^{1, p}(\Omega)\)), \ref{eq:3.17} holds for such functions. However, we want \ref{eq:3.17} to be satisfied for any globally Lipschitz continuous function \(f \in W^{1, \infty}(\Omega)\). We know that Lipschitz functions are differentiable almost everywhere, so \(f'(z)\) is well-defined. But what is \(f'(u(x))\)? The set \(K \coloneqq \{z \in \mathbb{R} : f'(z) \text{ does not exist}\}\) has zero measure, but \(u^{-1}(K) = V\) may have positive measure, implying \(f'(u(x))\) is not defined.

\begin{lemma}{}{}
    Let \(u \in W^{1, p}(\Omega), K \subset \mathbb{R}\)  with \(\text{meas}(K) = 0\) and \(v = u^{-1}(K)\). Then \(\nabla u(x) = 0\) a.e. on \(V\) (without proof).
\end{lemma}

Then \(f'(u(x))\nabla u\) is well-defined.

\begin{theorem}{}{}
    Let \(u \in W^{1, p}(\Omega)\) and \(f\) be globally Lipschitz. Then \(f(u) \in W^{1, p}(\Omega)\) and \ref{eq:3.17} holds.
\end{theorem}

\begin{proof}
    We will present the proof only for the case where
    \begin{equation*}
        f(z) = 
        \begin{cases*}
            z, \quad z > 0 \\
            0, \quad z \leq 0,
        \end{cases*}
    \end{equation*}
    which is crucial for the maximum principle. We denote
    \[
        u_{+}(x) = \max\{u(x), 0\}.
    \]
    We expect that \(\nabla u_{+} = \left\{\begin{aligned}
        \nabla u, & \quad u > 0 \\
        0, & \quad u \leq 0
    \end{aligned}\right.\). 
    
    Such \(\nabla u_{+} \in W^{1, p}(\Omega)\), so we only need to check the integration by parts formula.
    \begin{equation}\label{eq:3.18}
        \int_{\Omega} u_{+}(x) \text{div}\varphi(x) \,\mathrm{d}x = \int_{x: u > 0} \nabla u(x) \varphi(x) \,\mathrm{d}x \qquad \forall \varphi \in C^{\infty}_{0}. 
    \end{equation}
    To do this, we introduce the following \(C^{1}\)-approximations of \(f\) such that:
    \begin{enumerate}
        \item \(f'_{\varepsilon}\) are uniformly bounded
        \item \(f_{\varepsilon} = f\) if \(x \notin (0, \varepsilon)\)
    \end{enumerate} 
    Then 
    \[
        \int_{\Omega} f_{\varepsilon}(u(x))\text{div}\varphi(x) \,\mathrm{d}x = - \int_{\Omega} f'_{\varepsilon}(u(x)) \nabla u(x) \varphi(x) \,\mathrm{d}x \qquad \forall \varphi \in C^{\infty}_{0}.
    \]
    Obviously the LHS of the above equality tends to the LHS of the classical formula \ref{eq:3.18}. We need to check the convergence of the RHS.
    \begin{align*}
        \left\vert \int_{\Omega} (f'_{\varepsilon} \nabla u - f \nabla u) \varphi \,\mathrm{d}x \right\vert & \leq \int_{0 < u(x) < \varepsilon} C(1+\vert f'_{\varepsilon}(u(x))\vert) \vert \nabla u \vert \,\mathrm{d}x \\
        & \leq C_{1} \int_{0 < u(x) < \varepsilon} \vert \nabla u \vert \,\mathrm{d}x
    \end{align*}
    Let \(K_{\varepsilon} \coloneqq \{x \colon 0 < u(x) < \varepsilon\}\). Then \(K_{\varepsilon}\) are nested and \(\cap_{n=1}^{\infty}K_{\frac{1}{n}} = \emptyset\) by \(\sigma\)-additivity of the Lebesgue measure. Then \(\text{meas}(K_{\varepsilon}) \to 0\) as \(\varepsilon \to 0\). By absolute continuity of the Lebesgue integral, 
    \[
        \int_{0 < u(x) < \varepsilon} \vert \nabla u(x) \vert \,\mathrm{d}x \to 0 \text{ as } \varepsilon \to 0
    \]
    and the integration by parts formula \ref{eq:3.18} is proved. Thus, \(u_{+} \in W^{1, p}(\Omega)\) and indeed
    \[
        \nabla u_{+} = \left\{\begin{aligned}
            \nabla u, & \quad u > 0 \\
            0, & \quad u \leq 0
        \end{aligned}\right.
    \]
\end{proof}

\begin{corollary}{}{}
    Let \(u_{-}(x) = -\min\{u(x), 0\}\). Then \(u \in W^{1, p}(\Omega)\) and \(\nabla u_{-}(x) = \left\{\begin{aligned}
        -\nabla u, & \quad u < 0 \\
        0, & \quad u \geq 0
    \end{aligned}\right.\).
    Then \(\vert u(x) \vert = u_{+}(x) + u_{-}(x)\) is also in \(W^{1, p}(\Omega)\).
\end{corollary}

\begin{corollary}{}{}
    \(\nabla u(x) = 0\) a.e. on the set \(K\) where \(u(x) = 0\).
\end{corollary}

\begin{proof}
    Indeed, \(u = u_{+} + u_{-}, \nabla u = \nabla u_{+} - \nabla u_{-}\), and 
    \begin{align*}
        \int_{\Omega} u \text{div} \varphi \,\mathrm{d}x &= - \int_{\Omega} \nabla u \varphi \,\mathrm{d}x \\
        \int_{\Omega} u_{+} \text{div} \varphi - \int_{\Omega} u_{-} \text{div} \varphi &= - \int_{u > 0} \nabla u \varphi \,\mathrm{d}x - \int_{u = 0} \nabla u \varphi \,\mathrm{d}x - \int_{u < 0} \nabla u \varphi \,\mathrm{d}x
    \end{align*}
    Hence 
    \[
        \int_{u = 0} \nabla u \varphi \,\mathrm{d}x = 0 \qquad \forall \varphi \in C^{\infty}_{0} \implies \nabla u(x) = 0 \text{ a.e. on } u(x) = 0.
    \]
\end{proof}

\begin{corollary}{}{}
    \(\nabla u_{+} \cdot \nabla u_{-} = 0\) a.e. (because the supports of \(u_{+}\) and \(u_{-}\) are disjoint).
    \[
        \|\nabla u\|_{L^{p}}^{p} = \|\nabla u_{+}\|_{L^{p}}^{p} + \|\nabla u_{-}\|_{L^{p}}^{p} = \|\nabla \vert u \vert \|_{L^{p}}
    \] 
    \[
        \|u\|_{L^{p}}^{p} = \|u_{+}\|_{L^{p}}^{p} + \|u_{-}\|_{L^{p}}^{p} = \|\vert u \vert \|_{L^{p}}
    \]
\end{corollary}
We return to the maximum principle.

\begin{proposition}{}{weak_domination}
    Let \(u_{1}, u_{2} \in W^{1, 2}(\Omega)\) be weak solutions of 
    \(\begin{cases}
        -\Delta u_{1} = f_{1} \\
        \left. u_{1} \right|_{\partial \Omega} = u_{1}^{0}
    \end{cases}\) 
    and 
    \(\begin{cases}
        -\Delta u_{2} = f_{2} \\
        \left. u_{2} \right|_{\partial \Omega} = u_{2}^{0}
    \end{cases}\)
    , and let \(u_{1}^{0} \leq u_{2}^{0}\) a.e. and \(f_{1} \leq f_{2}\) in distributions. Then \(u_{1}(x) \leq u_{2}(x)\) a.e. in \(\Omega\).
\end{proposition}

\begin{proof}
    Let \(v = u_{1} - u_{2}\). It satisfies

    \(\begin{cases}
        -\Delta v = f \\
        \left. v \right|_{\partial \Omega} = v_{0}
    \end{cases}\), where \(f = f_{1} - f_{2} \leq 0\) and \(v_0 = u_{1}^{0} - u_{2}^{0} \leq 0\).

    It is sufficient to prove that \(v_{+}(x) = 0\) a.e. We multiply the equation with the test function \(\varphi = v_{+}(x) \in H^{1}_{0}(\Omega)\).
    \begin{align*}
        (\nabla v, \nabla v_{+}) &= (\nabla v_{+} - \nabla v_{-}, \nabla v_{+}) \\
        &= \|\nabla v_{+}\|_{L^{2}}^{2} \\
        &= (f, v_{+}) \leq 0
    \end{align*}
    Hence \(\|\nabla v_{+}\|_{L^{2}}^{2} = 0\), and by Friedrich's inequality, this implies that \(v_{+} = 0\) a.e.
\end{proof}

\begin{note}
    \(\ell \in D'(\Omega)\) is non-negative if and only if \(\left\langle l, \varphi \right\rangle \geq 0 \quad \forall \varphi \in D(\Omega), \varphi \geq 0\).
\end{note}

\begin{corollary}{}{}
    The classical maximum principle follows from proposition \ref{th:weak_domination} by taking \(f = f_{1} = 0\), \(u_{1} = u\) and \(u_{2} = \max\limits_{x \in \partial \Omega} u(x) = \text{const}\).
\end{corollary}

\begin{note}
    From our exposition, it looks like \(u_{+}, u_{-}\) approach is more general than the classical one. This is not true! It does not cover general operators \(L = \sum_{i, j}a_{ij}(x)\partial_{x_{i}}\partial_{x_{j}} + \sum_{i}b_{i}(x)\partial_{x_{i}} + c(x)\), but the classical theory does. 
\end{note}

Let us consider a more general operator
\[
    Lu = -\partial_{x_{i}}(a_{ij}(x)\partial_{x_{j}}) + c(x)u,
\]
where $a_{ij}$ is symmetric and uniformly elliptic, and \(c \in L^{\infty}(\Omega)\).

\subsubsection*{Spectral theory}
Analogous to the Laplacian due to the trick (ellipticity with parameter). Consider \(L_{N}u \coloneqq  Lu + Nu\), \(N\) is a constant, \(N \gg 1\). Then \(L_{N}\) is positive definite, so Riesz Representation Theorem works, and we may construct eigenvalues / eigenfunctions for \(L_{N}\) or \(L_{N}^{-1}\) by the Hilbert-Schmidt theorem. \\

Finally, since \(\sigma(L) = \sigma(L_{N}) - N\), we get an orthonormal, complete system \(\{e_{n}\}_{n=1}^{\infty}\) for \(L\) and corresponding eigenvalues \(\lambda_{1} \leq \lambda_{2} \leq \lambda_{3} \leq \dots\). The only diffierence is that now \(\lambda_{1}\) is not necessarily greater than zero. \\

Question: When does the maximum/comparison principle hold for \(L\)?

To answer this question, we use the min-max principle (which we have already used when finding the best constant in the Friedrich's inequality)
\begin{equation}\label{eq:3.19}
    \lambda_{1}(L) = \min\left\{\frac{(Lu, u)}{\|u\|^{2}_{L^{2}}}\right\}
\end{equation}

\begin{corollary}{}{}
    There exists a non-negative eigenfunction \(e_{1}(x) \geq 0\) which corresponds to the first eigenvalue \(\lambda_{1}\).
\end{corollary}

\begin{proof}
    Let \(e_{1}(x)\) be any eigenvector of \(L\) which corresponds to the 1st eigenvalue. Then the function \(\vert e_{1}(x) \vert \) is also a minimizer of \ref{eq:3.19}. Hence, \(\vert e_{1}(x) \vert \) is an eigenvector.
\end{proof}

\begin{note}
    Actually, the first eigenvalue is always simple and strictly positive inside of the domain \(\Omega\). This follows from the strict maximum principle which we will not prove here.
\end{note}

\begin{theorem}{}{}
    The comparison principle from the previous lecture holds for operator \(L\) if and only if \(\lambda_{1}(L) > 0\).
\end{theorem}

\begin{proof}
    Let \(\lambda_{1}(L) > 0\), \(u_{1}, u_{2} \in H^{1}_{0}(\Omega)\), and let \(Lu_{1} = f_{1}\), \(Lu_{2} = f_{2}\), \(\left. u_{1} \right|_{\partial \Omega} \leq \left. u_{2} \right|_{\partial \Omega}\), and \(f_{1} \leq f_{2}\). Then \(u_{1} \leq u_{2}\) a.e. 

    Indeed, for \(v = u_{1} - u_{2}\), we have \(Lv \leq 0\), \(\left. v \right|_{\partial \Omega} \leq 0\). 

    Multiplying by \(v_{+}\) (testing with \(v_{+} \in H^{1}_{0}(\partial \Omega)\)), we get \((Lv_{+}, v_{+}) \leq 0\). 
    But \((Lv_{+}, v_{+}) \geq \lambda_{1}(L)\|v_{+}\|_{L^{2}}^{2}\) by min-max. This implies \(\|v_{+}\|_{L^{2}}^{2} = 0\) since \(\lambda_{1}(L) > 0 \implies v_{+} = 0\) a.e. 
    
    Assume now that \(\lambda_{1} < 0\). Then the non-negative 1st eigenvalue \(e_{1}\) solves
    \[
        Le_{1} = \lambda_{1}e_{1} \leq 0, \left. e_{1} \right|_{\partial \Omega} = 0
    \]
    which contradicts the maximum principle.
\end{proof}

\begin{note}
    Same result holds for general non-self adjoint second order linear elliptic operators. More difficult. Non-self-adjoint operators need not have real spectrum. But, in the case of 2nd order scalar elliptic operators, the 1st eigenvalue remains real due to order preserving (Perron-Frobenius theorem).
\end{note}

\section{p-Laplacian and variational methods}

\begin{definition}{Weak convergence}{}
    Let \(V\) be a Banach space and \(V^{*}\) its dual space. Then \(\{x_{n}\}_{n=1}^{\infty} \in V\) is weakly convergent to \(x\), denoted \(x_{n} \rightharpoondown x\), if \(\ell x_{n} \to \ell x\), \(\forall \ell \in V\).
\end{definition}

\begin{definition}{Weak-star convergence}{}
    \(\{\ell_{n}\}_{n=1}^{\infty} \in V^{*}\) is weakly-star convergent to \(\ell\), denoted \(\ell_{n}x \overset{*}{\rightharpoondown} \ell\), if \(\ell_{n}x \to \ell x\), \(\forall x \in V\).
\end{definition}

\begin{theorem}{Banach-Alaoglu}{}
    Let \(V\) be a separable Banach space. Then the unit ball \(\overline{B_{1}(0)} \in V^{*}\) is (sequentially) compact in the weak-star topology.
\end{theorem}

\chapter{Linear evolutionary problems}

\end{document}